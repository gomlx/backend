// Code generated by github.com/ajroetker/go-highway/cmd/hwygen. DO NOT EDIT.

//go:build !arm64 && !(amd64 && goexperiment.simd)

package nn

import (
	"github.com/ajroetker/go-highway/hwy"
)

var LayerNormFloat16 func(input []hwy.Float16, output []hwy.Float16, normSize int, gamma []hwy.Float16, beta []hwy.Float16, epsilon hwy.Float16)
var LayerNormBFloat16 func(input []hwy.BFloat16, output []hwy.BFloat16, normSize int, gamma []hwy.BFloat16, beta []hwy.BFloat16, epsilon hwy.BFloat16)
var LayerNormFloat32 func(input []float32, output []float32, normSize int, gamma []float32, beta []float32, epsilon float32)
var LayerNormFloat64 func(input []float64, output []float64, normSize int, gamma []float64, beta []float64, epsilon float64)

// LayerNorm computes layer normalization over groups of normSize elements.
//
// For each group of normSize contiguous elements in input:
//
//	output[i] = (input[i] - mean) / sqrt(variance + epsilon) * gamma[i%normSize] + beta[i%normSize]
//
// The input and output slices must have length that is a multiple of normSize.
// gamma and beta are optional (pass nil to skip affine transform).
// This is the standard layer normalization used in transformers.
//
// This function dispatches to the appropriate SIMD implementation at runtime.
func LayerNorm[T hwy.Floats](input []T, output []T, normSize int, gamma []T, beta []T, epsilon T) {
	switch any(input).(type) {
	case []hwy.Float16:
		LayerNormFloat16(any(input).([]hwy.Float16), any(output).([]hwy.Float16), normSize, any(gamma).([]hwy.Float16), any(beta).([]hwy.Float16), any(epsilon).(hwy.Float16))
	case []hwy.BFloat16:
		LayerNormBFloat16(any(input).([]hwy.BFloat16), any(output).([]hwy.BFloat16), normSize, any(gamma).([]hwy.BFloat16), any(beta).([]hwy.BFloat16), any(epsilon).(hwy.BFloat16))
	case []float32:
		LayerNormFloat32(any(input).([]float32), any(output).([]float32), normSize, any(gamma).([]float32), any(beta).([]float32), any(epsilon).(float32))
	case []float64:
		LayerNormFloat64(any(input).([]float64), any(output).([]float64), normSize, any(gamma).([]float64), any(beta).([]float64), any(epsilon).(float64))
	}
}

func init() {
	_ = hwy.NoSimdEnv // silence unused import
	initLayernormFallback()
}

func initLayernormFallback() {
	LayerNormFloat16 = BaseLayerNorm_fallback_Float16
	LayerNormBFloat16 = BaseLayerNorm_fallback_BFloat16
	LayerNormFloat32 = BaseLayerNorm_fallback
	LayerNormFloat64 = BaseLayerNorm_fallback_Float64
}
